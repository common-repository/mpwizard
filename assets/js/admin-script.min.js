jQuery(document).ready(function($){let mpwizardPicPholder=mpwizard_ajax_obj.img_placeholder;function mpwizardResetImgPholder(){$("#mpwizard-btn-clean-img").css("visibility","hidden"),$("#mpwizard-btn-picture-img").attr("src",mpwizardPicPholder),$("#mpwizard-btn-picture-url").val("")}function mpwizardCopyToClipboard(element,contentToCopy="html"){const mpwizardTempInput=$("<input>");if($("body").append(mpwizardTempInput),"html"===contentToCopy)mpwizardTempInput.val($(element).html()).select();else if("text"===contentToCopy)mpwizardTempInput.val(element).select();else{const myElement=$(element);mpwizardTempInput.val(myElement.data(contentToCopy)).select()}document.execCommand("copy"),mpwizardTempInput.remove()}function mpwizardBtnAddSubmmitState(disabled,html){$("#mpwizard-btn-add-submmit").prop("disabled",disabled),$("#mpwizard-btn-add-submmit").html(html)}function mpwizardAddBtnValidateForm(){return!!$("#mpwizard-btn-add-form")[0].checkValidity()||($("#mpwizard-btn-general-settings-tab").addClass("nav-tab-active"),$("#mpwizard-btn-style-settings-tab").removeClass("nav-tab-active"),$("#mpwizard-btn-general-settings").css("display","grid"),$("#mpwizard-btn-style-settings").css("display","none"),$("#mpwizard-btn-add-form")[0].reportValidity())}function removeProcessing(element){$(element).find(".mpwizard-ip-copy").css("display","inline"),$(element).find("#processing").remove()}function appendCheck(element){const check=$('<i class="fas fa-check-circle icon-green"></i>');$(element).append(check),check.fadeOut(2600)}"no"===mpwizard_ajax_obj.log&&$("#mpwizard-fieldset").attr("disabled","disabled"),function(){const imageSrc=$("#mpwizard-btn-picture-img").attr("src");void 0===imageSrc||""===imageSrc||imageSrc.includes("image-placeholder")||$("#mpwizard-btn-clean-img").css("visibility","visible")}(),$("#mpwizard-btn-picture").click(function(e){e.preventDefault(),mediaUploader=wp.media.frames.file_frame=wp.media({title:mpwizard_ajax_obj.translations.SelectPicture,button:{text:mpwizard_ajax_obj.translations.SelectPicture},multiple:!1}),mediaUploader.on("select",function(){attachment=mediaUploader.state().get("selection").first().toJSON(),$("#mpwizard-btn-picture-img").attr("src",attachment.url),$("#mpwizard-btn-picture-url").val(attachment.url),$("#mpwizard-btn-clean-img").css("visibility","visible")}),mediaUploader.open()}),$("#mpwizard-btn-clean-img").click(function(e){e.preventDefault(),mpwizardResetImgPholder()}),$("#mpwizard-btn-add-form").submit(function(event){if(event.preventDefault(),!0===mpwizardAddBtnValidateForm()){mpwizardBtnAddSubmmitState(!0,'Registrar <i class="fas fa-circle-notch fa-spin"></li>');let mpwizarFormData=new FormData(this);mpwizarFormData.append("_ajax_nonce",mpwizard_ajax_obj.nonce),mpwizarFormData.append("action","mpwizard_add_button");const urlParams=new URLSearchParams(window.location.search),idParam=urlParams.get("id");null!==idParam&&mpwizarFormData.append("post_id",idParam),$.ajax({url:mpwizard_ajax_obj.ajax_add_url,data:mpwizarFormData,processData:!1,contentType:!1,type:"POST",success:function(data){-1!==data.post_id?(null===idParam&&($("#mpwizard-btn-title").val(""),$("#mpwizard-btn-quantity").val("1"),$("#mpwizard-btn-price").val(""),$("#mpwizard-btn-text").val(""),mpwizardResetImgPholder(),$("#mpwizard-btn-desc").val(""),$("#mpwizard-btn-refnumber").val(""),$("#mpwizard-btn-activationd").val(""),$("#mpwizard-btn-expirationd").val("")),$.alert({title:null!==idParam?mpwizard_ajax_obj.translations.UpdatedProduct:mpwizard_ajax_obj.translations.RegisteredProduct,content:mpwizard_ajax_obj.translations.HereIsYourPaymentLink+': <br><strong id="mpwizard-link">'+data.init_point+'</strong> <br><span id="mpwizard-shortcode-copied">'+mpwizard_ajax_obj.translations.ClickOnItToCopy+"</span> <br>",type:"green",boxWidth:"400px",useBootstrap:!1,icon:"fas fa-check-circle fa-2x",escapeKey:!0,backgroundDismiss:!0})):$.dialog({title:mpwizard_ajax_obj.translations.AnErrorHasOccurred,content:data.error,type:"red",boxWidth:"400px",useBootstrap:!1,icon:"fas fa-exclamation-circle fa-2x",escapeKey:!0,backgroundDismiss:!0}),mpwizardBtnAddSubmmitState(!1,null!==idParam?mpwizard_ajax_obj.translations.Update:mpwizard_ajax_obj.translations.Register)},error:function(data){$.dialog({title:mpwizard_ajax_obj.translations.AnErrorHasOccurred,content:data.error,type:"red",boxWidth:"400px",useBootstrap:!1,icon:"fas fa-exclamation-circle fa-2x",escapeKey:!0,backgroundDismiss:!0}),mpwizardBtnAddSubmmitState(!1,null!==idParam?mpwizard_ajax_obj.translations.Update:mpwizard_ajax_obj.translations.Register)}})}}),$(document).on("click","#mpwizard-link",function(event){event.preventDefault(),mpwizardCopyToClipboard("#mpwizard-link"),$("#mpwizard-shortcode-copied").html(mpwizard_ajax_obj.translations.Copied),$("#mpwizard-shortcode-copied").css("color","#2ECC71")}),$(document).on("click",".mpwizard-sc-copy",function(event){event.preventDefault(),mpwizardCopyToClipboard($(this).parent(),"content"),appendCheck($(this).parent())}),$(document).on("click",".mpwizard-ip-copy",function(element){element.preventDefault();const myElement=$(this),parent=myElement.parent();var processing=parent.data("postId");let mpwizarFormData=new FormData;mpwizarFormData.append("_ajax_nonce",mpwizard_ajax_obj.nonce),mpwizarFormData.append("action","mpwizard_get_init_point"),mpwizarFormData.append("product",processing),element=parent,processing=$('<i id="processing" class="fas fa-circle-notch fa-spin icon-green"></i>'),$(element).append(processing),$(element).find(".mpwizard-ip-copy").css("display","none"),$.ajax({url:mpwizard_ajax_obj.ajax_init_point_url,data:mpwizarFormData,processData:!1,contentType:!1,type:"POST",success:function(data){-1!==data.init_point&&""!==data.init_point?("#"===parent.data("content")&&parent.attr("data-content",data.init_point),mpwizardCopyToClipboard(data.init_point,"text"),removeProcessing(parent),appendCheck(parent)):(removeProcessing(parent),$.alert({title:"",content:data.error,type:"red",boxWidth:"400px",useBootstrap:!1,icon:"fas fa-exclamation-circle fa-2x",escapeKey:!0,backgroundDismiss:!0}))},error:function(data){removeProcessing(parent),$.alert({title:"",content:data.error,type:"red",boxWidth:"400px",useBootstrap:!1,icon:"fas fa-exclamation-circle fa-2x",escapeKey:!0,backgroundDismiss:!0})}})}),$(".mpwizard-delete-product").click(function(event){event.preventDefault();const poductId=this.dataset.productId;$.confirm({title:"",content:mpwizard_ajax_obj.translations.AreYouSureYouWantToRemoveThisProduct,type:"orange",boxWidth:"400px",useBootstrap:!1,icon:"far fa-trash-alt fa-2x",escapeKey:!0,buttons:{confirm:{text:"Aceptar",action:function(){let mpwizarFormData=new FormData;mpwizarFormData.append("_ajax_nonce",mpwizard_ajax_obj.nonce),mpwizarFormData.append("action","mpwizard_delete_product"),mpwizarFormData.append("product",poductId),$.ajax({url:mpwizard_ajax_obj.ajax_delete_url,data:mpwizarFormData,processData:!1,contentType:!1,type:"POST",success:function(data){-1!==data.post_id?location.reload():$.alert({title:"",content:data.error,type:"red",boxWidth:"400px",useBootstrap:!1,icon:"fas fa-exclamation-circle fa-2x",escapeKey:!0,backgroundDismiss:!0})},error:function(data){$.alert({title:"",content:data.error,type:"red",boxWidth:"400px",useBootstrap:!1,icon:"fas fa-exclamation-circle fa-2x",escapeKey:!0,backgroundDismiss:!0})}})}},cancel:{text:mpwizard_ajax_obj.translations.Cancel}}})})});